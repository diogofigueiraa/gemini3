<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini3 - Dynamic Motion Carousel</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for dark theme and drag experience */
        :root {
            /* These variables are for the JS calculation/styles, not just static CSS */
            --card-width: 60vw;
            --card-height: 80vh;
            --gap-size: 2rem;
            --max-blur: 5px;
            --max-scale-reduction: 0.05; /* 1.0 to 0.95 */
        }

        @media (max-width: 768px) {
            :root {
                --card-width: 85vw;
                --card-height: 70vh;
            }
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d0d0d; /* Very dark background */
            color: #fff;
            overflow: hidden; /* Hide main body scrollbar */
        }

        /* Container for the draggable cards */
        #carousel-container {
            display: flex;
            align-items: center;
            height: 100vh;
            overflow-x: scroll;
            cursor: grab;
            padding-left: calc(50vw - (var(--card-width) / 2));
            padding-right: calc(50vw - (var(--card-width) / 2));
            gap: var(--gap-size);
            scrollbar-width: none; /* Firefox */
            scroll-behavior: smooth; /* For programmatically jumping cards */
        }

        #carousel-container::-webkit-scrollbar {
            display: none; /* Chrome, Safari */
        }

        /* Individual film card style - base styles */
        .film-card {
            flex-shrink: 0;
            width: var(--card-width);
            height: var(--card-height);
            border-radius: 0.75rem;
            position: relative;
            background-size: cover;
            background-position: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            will-change: transform, filter; 
            transition: transform 0.1s linear, filter 0.1s linear; 
        }

        .card-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.0) 30%);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 2.5rem;
            border-radius: 0.75rem;
        }

        .text-detail {
            font-size: 0.875rem;
            opacity: 0.7;
            letter-spacing: 0.05em;
        }

        .title-text {
            font-size: 3rem;
            line-height: 1;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
        }

        .explore-btn {
            margin-top: 1.5rem;
            background: #06b6d4; /* Cyan accent (tailwind cyan-500) */
            color: #0d0d0d;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            border-radius: 9999px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: background-color 0.2s;
            width: fit-content;
        }

        .explore-btn:hover {
            background: #22d3ee; /* tailwind cyan-400 */
        }

        /* Nav item styles */
        .nav-item {
            cursor: pointer;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .nav-item.active {
            opacity: 1.0;
        }

        .nav-item:not(.active) {
            opacity: 0.3;
        }
    </style>
</head>
<body class="overflow-x-hidden">

<!-- Mock Navigation Bar -->
<header class="fixed top-0 left-0 right-0 z-10 p-6 flex justify-between items-center text-white">
    <div class="text-xl font-bold tracking-widest">GEMINI3</div>
    <div id="nav-list" class="flex gap-4 p-2 rounded-full bg-gray-800/50 backdrop-blur-sm border border-gray-700">
        <!-- Nav items will be generated here -->
    </div>
</header>

<!-- Main Carousel Container -->
<div id="carousel-container">
    <!-- Card elements will be generated by JavaScript -->
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Inline SVG for the button icon
        const ArrowRightIconSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14" /><path d="m12 5 7 7-7 7" /></svg>`;

        // Data for the film cards
        const filmData = [
            { title: "MY PROJECT X", year: 2024, category: "DOCUMENTARY", runtime: "90 MIN", image: "https://placehold.co/600x800/1E1E1E/98AFC7?text=MY+PROJECT+X" },
            { title: "ANA MAXIM", year: 2023, category: "SHORT FILM", runtime: "15 MIN", image: "https://placehold.co/600x800/333333/fff?text=ANA+MAXIM" },
            { title: "OUTSIDER FREUD", year: 2024, category: "DOCUMENTARY", runtime: "60 MIN", image: "https://placehold.co/600x800/1A1A1A/A0E0FF?text=OUTSIDER+FREUD" },
            { title: "SAVOY", year: 2022, category: "SHORT FILM", runtime: "25 MIN", image: "https://placehold.co/600x800/222222/D0B0FF?text=SAVOY" },
            { title: "THE LAST TRIP", year: 2025, category: "FEATURE FILM", runtime: "120 MIN", image: "https://placehold.co/600x800/444444/FFD700?text=THE+LAST+TRIP" }
        ];

        const carouselContainer = document.getElementById('carousel-container');
        const navList = document.getElementById('nav-list');
        
        if (!carouselContainer || !navList) {
            console.error('Could not find required DOM elements (carousel-container or nav-list).');
            return;
        }

        // Global state for drag and interaction
        let activeIndex = 0;
        let isDown = false;
        let startX;
        let scrollLeft;
        let scrollTimeout;

        // --- 1. CORE MOTION LOGIC ---

        function updateCardMotion(card) {
            const container = carouselContainer;

            const viewportCenter = container.scrollLeft + container.clientWidth / 2;
            const cardCenter = card.offsetLeft + card.clientWidth / 2;

            const distance = Math.abs(cardCenter - viewportCenter);
            const maxDistance = container.clientWidth / 2;
            
            // Normalize distance: 0 (center) to 1 (max blur/scale change at edges)
            const normalizedDistance = Math.min(1, distance / (maxDistance * 0.8));
            
            const rootStyle = getComputedStyle(document.documentElement);
            const maxBlur = parseFloat(rootStyle.getPropertyValue('--max-blur'));
            const maxScaleReduction = parseFloat(rootStyle.getPropertyValue('--max-scale-reduction'));

            // Scale: from 1.0 (center) down to 1.0 - maxScaleReduction (edge)
            const scale = 1.0 - (normalizedDistance * maxScaleReduction); 

            // Blur: from 0px (center) up to maxBlur (edge)
            const blur = normalizedDistance * maxBlur; 
            
            // Brightness: from 1.0 (center) down to 0.6 (edge)
            const brightness = 1.0 - (normalizedDistance * 0.4); 

            // Apply styles directly
            card.style.transform = `scale(${scale})`;
            card.style.filter = `brightness(${brightness}) blur(${blur}px)`;
        }

        function updateAllCardMotions() {
            document.querySelectorAll('.film-card').forEach(updateCardMotion);
        }
        
        // --- 2. INITIALIZATION AND NAV ---

        function initializeCarousel() {
            filmData.forEach((film, index) => {
                // Create Card Element
                const card = document.createElement('div');
                card.className = 'film-card';
                card.id = `card-${index}`;
                card.style.backgroundImage = `url('${film.image}')`;
                card.setAttribute('data-index', index);
                card.innerHTML = `
                    <div class="card-overlay">
                        <div class="text-detail">${film.category}</div>
                        <div class="title-text">${film.title}</div>
                        <div class="flex gap-4 text-detail">
                            <span>YEAR ${film.year}</span>
                            <span>RUNTIME ${film.runtime}</span>
                        </div>
                        <button class="explore-btn w-fit">
                            EXPLORE ${ArrowRightIconSvg}
                        </button>
                    </div>
                `;
                carouselContainer.appendChild(card);

                // Create Nav Item Element
                const navItem = document.createElement('div');
                navItem.className = 'nav-item';
                navItem.id = `nav-${index}`;
                navItem.textContent = film.title;
                navItem.onclick = () => scrollToCard(index);
                navList.appendChild(navItem);
            });

            // Add scroll listener and initial setup
            carouselContainer.addEventListener('scroll', handleScroll);
            
            // Initial run to set motion and active state
            updateAllCardMotions();
            updateActiveCardIndex(findNearestCardIndex());
            // Ensure the first card is centered on load after a slight delay for layout to settle
            setTimeout(() => {
                scrollToCard(0); 
            }, 50);
        }
        
        // --- 3. SCROLL AND SNAP LOGIC ---

        function findNearestCardIndex() {
            const containerCenter = carouselContainer.scrollLeft + carouselContainer.clientWidth / 2;
            let nearestIndex = 0;
            let minDistance = Infinity;

            carouselContainer.querySelectorAll('.film-card').forEach((card, index) => {
                const cardCenter = card.offsetLeft + card.clientWidth / 2;
                const distance = Math.abs(cardCenter - containerCenter);

                if (distance < minDistance) {
                    minDistance = distance;
                    nearestIndex = index;
                }
            });
            return nearestIndex;
        }

        function updateActiveCardIndex(newIndex) {
            if (activeIndex === newIndex) return;

            // Deactivate old nav item
            const oldNav = document.getElementById(`nav-${activeIndex}`);
            if (oldNav) oldNav.classList.remove('active');

            // Activate new nav item
            const newNav = document.getElementById(`nav-${newIndex}`);
            if (newNav) newNav.classList.add('active');

            activeIndex = newIndex;
        }

        function scrollToCard(index) {
            const card = document.getElementById(`card-${index}`);
            if (card) {
                // Calculation to center the card: 
                // card.offsetLeft - (ContainerWidth / 2) + (CardWidth / 2)
                const targetScrollLeft = card.offsetLeft - (carouselContainer.clientWidth / 2) + (card.clientWidth / 2);
                carouselContainer.scrollTo({
                    left: targetScrollLeft,
                    behavior: 'smooth'
                });
                updateActiveCardIndex(index);
            }
        }

        function handleScroll() {
            updateAllCardMotions();
            
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                const nearestIndex = findNearestCardIndex();
                
                if (!isDown) { 
                    scrollToCard(nearestIndex);
                }
                updateActiveCardIndex(nearestIndex);
            }, 150);
        }
        
        // --- 4. DRAG BEHAVIOR SETUP ---

        function startDrag(e) {
            isDown = true;
            const clientX = e.touches ? e.touches[0].pageX : e.pageX;
            
            startX = clientX - carouselContainer.offsetLeft;
            scrollLeft = carouselContainer.scrollLeft;
            
            carouselContainer.style.userSelect = 'none';
            carouselContainer.style.cursor = 'grabbing';
            
            if (e.type === 'touchstart') {
                e.preventDefault();
            }
        }

        function endDrag() {
            if (!isDown) return;
            isDown = false;
            carouselContainer.style.cursor = 'grab';
            carouselContainer.style.userSelect = 'auto';

            const nearestIndex = findNearestCardIndex();
            scrollToCard(nearestIndex);
        }

        function moveDrag(e) {
            if (!isDown) return;
            
            const clientX = e.touches ? e.touches[0].pageX : e.pageX;
            
            e.preventDefault();
            const x = clientX - carouselContainer.offsetLeft;
            const walk = (x - startX) * 1.5; // Scroll speed multiplier
            carouselContainer.scrollLeft = scrollLeft - walk;
            handleScroll();
        }

        // Assigning event listeners
        carouselContainer.addEventListener('mousedown', startDrag);
        document.addEventListener('mouseup', endDrag); // Use document for robustness
        carouselContainer.addEventListener('mouseleave', endDrag);
        carouselContainer.addEventListener('mousemove', moveDrag);

        // Touch events for mobile support
        carouselContainer.addEventListener('touchstart', startDrag);
        document.addEventListener('touchend', endDrag); // Use document for robustness
        carouselContainer.addEventListener('touchmove', moveDrag);

        // --- 5. START APPLICATION ---
        initializeCarousel();
        
        // Re-center on window resize
        window.addEventListener('resize', () => {
            updateAllCardMotions();
            scrollToCard(activeIndex);
        });
    });
</script>
</body>
</html>